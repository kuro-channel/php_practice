### HTTPは「ステートレス」なプロトコル
- HTTPはステートレス（=状態を持たない）
  - WebブラウザとWebサーバーへの一連のやり取りにおいて、状態を管理する仕組みがない
  - ECサイト等で状態を保持し管理する必要がある場合には**Cookie**と呼ばれるデータが使われる

- Cookieのやり取り
  - Cookie: WebブラウザとWebアプリケーション間で情報を交換できるようにした仕組み。Cookieという情報を相互で送る。
  - WebサーバーはHTTPレスポンスに「**Set-Cookie**」ヘッダーを含めることで、Cookiwを送信できる。
  - Cookieの仕組み： https://www.soumu.go.jp/main_sosiki/joho_tsusin/security_previous/kiso/k01_cookie.htm
 
  【**流れ**】
  1. Webブラウザ: WebサーバーAにリクエスト
  2. WebサーバーA: 接続してきたWebブラウザに対して、コンテンツ等と一緒に**Cookie**を送信 
  3. Webブラウザ: 2で送られたCookieを保存しておく。2回目にWebサーバーAに接続する際に、Cookieをリクエストと一緒に渡す
  4. WebサーバーA: 送信されたCookieを確認し、Webブラウザを特定。  

  ※ WebブラウザがWebサーバーA以外のサーバ（=初めてリクエストを送るサーバー）には送らない。　　
  
- ブラウザに一切キャッシュさせたくない
  - https://qiita.com/hkusu/items/d40aa8a70bacd2015dfa#%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%AB%E4%B8%80%E5%88%87%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%95%E3%81%9B%E3%81%9F%E3%81%8F%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88
  - サーバからクライアントへのHTTP応答ヘッダ ```Cache-Control "no-cache" ```
  - いちどキャッシュに記録されたコンテンツは、現在でも有効か否かを本来のWebサーバに問い合わせて確認がとれない限り再利用してはならない
  - アクセス毎に内容が変わったり、サーバにアクセスしてもらわないと困るようなコンコンテンツの場合に使う
  
 - セッション
   - Cookieの問題点： ユーザー名やパスワード等、重要な情報をCookieに保存することはリスクがある
   - WHY?: PC上に保存してあるCookieは比較的簡単に除ける。/ 個人情報や機密情報をHTTPリクエスト、レスポンス上でやり取りすると除くことが出来る。
   - 一連の関連性のある処理の流れ： **セッション**　という仕組みを使って、より安全に多くの情報を保持する。
   - セッションの例：ECサイトでの買い物　↓↓
   - 「商品を選ぶ」「商品を買い物かごに入れる」「買い物かごの中身を確認する」「商品を購入する」 > 一連の処理の流れを「セッション」という。　
   ‐ 「ログイン」「注文するピザを選択」「注文確認」「ログアウト」　複数回あった、HTTPリクエストの一連の流れ
   
  - 徳丸本によると…p.65
    - Cookie上でアプリケーションデータを保持するのは以下の理由から望ましくない。
    - **1.Cookieが保持できる値の個数や文字列長に制限がある。**
    - **2.Cookieの値は利用者本人には参照、変更できるので、秘密情報の格納には向かない。**

 - セッションの使い方
   - Webサーバーで**セッションID**を生成し、そのセッションIDを**Cookie**に含めてWebブラウザに送信する。
   - セッションIDと紐づくセッション情報（=一連の処理の流れの情報）はWebサーバで管理する。
  
   【**流れ**】
    1. Webブラウザ: WebサーバーAにリクエスト
    2. WebサーバーA: 接続してきたWebブラウザに対して、**セッションIDを発行**し、CookieにセッションIDを格納して返却
    3. Webブラウザ: 2で送られたCookie（セッションID）を保存しておく。2回目にWebサーバーAに接続する際に、Cookie（セッションID）をリクエストと一緒に渡す
    4. WebサーバーA: 送信されたCookie（セッションID）を確認し、Webブラウザを特定。 そのユーザーの状態を復元する。
    ※ 状態を復元： ログイン状態やショッピングセンターの中身等。
    
  #### Cookieの中に情報をそのまま格納する or セッションIDだけ格納するのか の違い　　
   
   ＜出典＞
   1. プロになるためのWeb技術入門　http://www.littleforest.jp/webtext/#info　　
   2. 安全なWebアプリケーションの作り方 第2版　https://wasbook.org/
   3. この1冊で全部わかるWeb技術の基本 